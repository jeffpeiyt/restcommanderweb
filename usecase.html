<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
   <title>REST Commander - Parallel Async HTTP Client as a Service, Speaks HTTP at Scale (Formerly known as REST Superman) </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta name="description" content="REST Commander - Parallel Async HTTP client as a service ; Akka based REST client, scalable web server monitoring, web service, eBay Opensource. (Formerly known as REST Superman) ">
    <meta name="author" content="eBay Software Foundation">
    
    <!-- Le styles -->
    
	
    <link href="public/stylesheets/bootstrap.min.css" rel="stylesheet">
    <link href="public/stylesheets/font-awesome.min.css" rel="stylesheet">    
    <link href="public/stylesheets/bootstrap-responsive.min.css" rel="stylesheet">
	<link href="public/stylesheets/docs.css" rel="stylesheet">
	
	 <!-- Prettify styles
  	<link href="public/stylesheets/sunburst.css" rel="stylesheet">
  	
	 <link href="public/javascripts/prettify/sunburst.css" rel="stylesheet">
	  -->
  	<link href="public/javascripts/prettify/prettify.css" rel="stylesheet">
  <link rel="shortcut icon" href="public/images/ico/favicon.ico">
    
	
    
    
  </head>

  <body>
  
  
  <body data-spy="scroll"  data-target=".bs-docs-sidebar"  onload="prettyPrint()">





<div class="navbar navbar-fixed-top navbar-inverse">
	<div class="navbar-inner">
			<a class="brand" href="index.html">Commander</a>
		<div class="container">
		
			<div class="nav-collapse">
				<ul class="nav">
					
          <li><a href="index.html">Home</a></li>
          <li><a href="get-started.html">Get Started</a></li>
          <li><a href="documentation.html">Documentation</a></li>
          <li class="active"><a href="usecase.html">Use Cases</a></li>
          <li><a href="monitoring-sample.html">Monitoring Sample</a></li>
          <li><a href="contact.html">Contact</a></li>     
					          
				</ul>
			</div>
		</div>
	</div>
</div>

<!-- Subhead
================================================== -->

<header class="jumbotron subhead" id="overview">
  <div class="container">
    <h1>Use Cases and Recipes</h1>
    <p class="lead">Common use cases and recipes of REST Commander, REST APIs examples. -- REST Commander is not just an HTTP Client, it is an HTTP Client as a service.</p>
  </div>
</header>

  <div class="container-fluid">


    <!-- Docs nav
    ================================================== -->
    <div class="row-fluid">
      <div class="span3 bs-docs-sidebar" >
        <ul class="nav nav-list bs-docs-sidenav"  data-spy="affix" data-offset-top="200">
          <li><a href="#usecase-overview"><i class="icon-chevron-right"></i>Use Cases Overview</a></li>
          <li><a href="#usecase-same-request"><i class="icon-chevron-right"></i>Same Request to Different Servers</a></li>
          <li><a href="#usecase-different-servers"><i class="icon-chevron-right"></i>Different Requests to Different Servers</a></li>
          <li><a href="#usecase-different-requests">Different Requests to Same Server</a></li>
          <li><a href="#usecase-request-options"><i class="icon-chevron-right"></i> Summary of Request Options</a></li>
        </ul>
      </div>
      <div class="span9">



        <!-- Download
        ================================================== 

      


      -->
        <section id="usecase-overview">

          <p class="lead"> Commander REST APIs enables complex request patterns, such as sending same or different requests to different servers, and different requests to single server. Further, it can aggregate the server response based on custom rules. Here are some common use cases with examples.
      For your convenience, import the <a href="http://www.getpostman.com/">Postman</a> (a rest client as Chrome plugin) <a href="sample_script/SUPERMAN_USECASES.json">request collection</a> immediately to try out!
          </p>
            <p class="lead">Table of Use Cases</p>
          <table class="table table-striped table-hover">
              <thead>
                <tr>
                <th>Request Type</th>
                <th>Use Case</th>
                <th>Examples</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Same request to different servers</strong></td>
                  <td>1. Monitoring cluster servers status where the status can be checked from same request;<br>2. Push same configuration to all the servers.</td>
                  <td>Assuming we want to monitor a list of servers, on which the health status can be checked through a uniformed &quot;validateInternals.html&quot; page. REST Commander can send request to parse health status information from server response, and aggregate the overall health status of cluster. (<a href="#usecase-same-request">See example</a>)</td>
                </tr>
                <tr>
                  <td><strong>Different Requests to different servers</strong></td>
                  <td>1. Push server-specific configuration to different servers, such as configuration with topology, ip address data;<br>2. Querying different servers with  information which needs to be accessed through different requests.</td>
                  <td>Assuming we have a list of different servers, where each server has a unique URL/API or a page with unique name to describe its job id running on the server, 
          and its current job execution progress. By using REST Commander, you can easily automate the process to aggregate job execution information from these servers. (<a href="#usecase-different-servers">See example</a>)</td>
                </tr>
                <tr>
                  <td><strong>Different requests to same server</strong></td>
                  <td>Get multiple response from same server in parallel, and aggregate the response based on custom rules.</td>
                  <td>By querying the SOAP(<a href="http://wsf.cdyne.com/WeatherWS/Weather.asmx?WSDL">WSDL</a>)-based public weather web service: a central server (single target) with multiple requests each with a zip code, you can aggregate the wind/temperature/city information for these different zip code. See example: (<a href="#usecase-different-requests">REST APIs</a>, <a href="documentation.html#Wizards">GUI Wizards</a> ) </td>
                </tr>
              </tbody>
            </table>


          <p class="lead">In more generic and abstract form, these examples demonstrates Commander ability for the following recipes over HTTP.</p>
          <p class="lead">Table of Recipes (more generic form)</p>
          <table class="table table-striped table-hover">
              <thead>
                <tr>
                <th>Recipe</th>
                <th>Description</th>
             
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong>Federated data aggregation</strong></td>
                  <td>Not limit to monitor or config pushes, Commander is great for aggregate any data that accessible by a HTTP URL, from a distributed environment where there are a large number of HTTP endpoints. </td>
                </tr>
                <tr>
                  <td><strong>Scalable task execution</strong></td>
                  <td> e.g. you have HTTP based Puppet/SaltStack agents running on your servers, scalably executing tasks in parallel through these agents are simple. Commander will act as the agent master to talk with the agents via HTTP.</td>
                </tr>
           
              </tbody>
            </table>


        </section>





        <!-- Uniform requests
        ================================================== -->
        <section id="usecase-same-request">
          <div class="page-header">
            <h1>1. Same Request to Different Servers</h1>
          </div>

          <p class="lead">Assuming we want to monitor a list of servers, on which the health status can be checked through a uniformed &quot;validateInternals.html&quot; page. For example:<br></p>
<ul>
  <li><a href="http://www.jeffpei.com/validateInternals.html">http://www.jeffpei.com/validateInternals.html</a></li>
<li> <a href="http://www.yangli907.com/validateInternals.html">http://www.yangli907.com/validateInternals.html</a></li>
<li><a href="http://www.restsuperman.com/validateInternals.html">http://www.restsuperman.com/validateInternals.html</a></li>
</ul>
Each of the server stores a page called validateInternals.html, which shows the host name, server status, CPU usage information, and so on. For example, on one of the server, the validateInternals.html page looks like below:<br>
<pre class="prettyprint lang-html linenums">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;
&lt;h1&gt;My Server Status&lt;/h1&gt;
&lt;h4&gt;System Health&lt;/h4&gt;
&lt;table border='1'&gt;
    &lt;tr&gt;
        &lt;td&gt;Memory-Used-KB&lt;/td&gt;
        &lt;td&gt;28338&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;CPU-Usage-Percent&lt;/td&gt;
        &lt;td&gt;23.54&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Server-Is-Healthy&lt;/td&gt;
        &lt;td&gt;False&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
        &lt;td&gt;Host-Name&lt;/td&gt;
        &lt;td&gt;www.yangli907.com&lt;/td&gt;
    &lt;/tr&gt;
	&lt;/table&gt;
	&lt;h4&gt;A demo page to show a sample server health page for use cases by REST Commander.&lt;/h4&gt;
&lt;/body&gt;
&lt;/html&gt;

</pre>
We want to send same http request (/validateInternals.html) to every server in the cluster, aggregate and analyze the health status of the cluster from the server response, which shows in the &lt;td&gt;Server-Is-Healthy&lt;/td&gt; row. Then we can 
further take appropriate solutions to fix the unhealthy ones, in order to bring them back to healthy status.
<h3>a. Define Request Type and Aggregation Rule</h3>
The first step is to define request command sent to the servers. In this case we want to get the same server endpoint &quot;/validateInternals.html&quot;, so the request command looks like:
<br>
<pre>
GET_VALIDATE_INTERNAL GET https 80 /validateInternals.html 0 -1 -1 SUPERMAN_GLOBAL
```$AM_FULL_CONTENT
</pre>
(for the meaning of each segment above, please refer to <a href="documentation.html#a_Commands">Commands Section</a> in Documentation page.)
<br><br>Then you need to define the aggregation rules, which tells REST Commander what's the value we are interested in to aggregate. For example, in the request, we need to specific the name(&quot;aggregationType&quot;) and expression(&quot;newAggregationExpression&quot;) of the aggregation rule:
<pre>&quot;aggregationType&quot; : &quot;PATTERN_PARSE_MONITOR_HEALTH&quot;,<br>&quot;newAggregationExpression&quot; : &quot;.*&lt;td&gt;Server-Is-Healthy&lt;/td&gt;\s*&lt;td&gt;(.*?)&lt;/td&gt;[\s\S]*&quot;</pre>


<div class="alert alert-block">
<p><strong>Note!</strong>: In REST APIs to Commander, the aggregation rule (regular expression) must be <a href+"http://meyerweb.com/eric/tools/dencoder/">URL encoded</a> to avoid special characters.</p>
</div>

Here the <b>(.*?)</b> expression shows we need to extract the content in the html table cell at "Server-Is-Healthy" row.


<h3>b. Send Request</h3> 
The second step is building the json request body, which tells REST Commander how to build http request for each server, and what's the aggregation rules.

<br><br>POST http://localhost:9000/commands/genUpdateSendCommandWithReplaceVarMapAdhocJson   (Commander running at http://localhost:9000)

<br><pre class="prettyprint lang-java linenums">
POST BODY<br>
{
   "targetNodes":[
      "www.restsuperman.com",
      "www.jeffpei.com",
      "www.yangli907.com"
   ],
  
  "useNewAgentCommand":"true",
   "newAgentCommandLine":"GET_VALIDATE_INTERNAL GET http 80 /validateInternals.html 0 0 5000 SUPERMAN_GLOBAL",
     "newAgentCommandContentTemplate":"$AM_FULL_CONTENT",
   "willAggregateResponse":false,
   "useNewAggregation":true,
   "aggregationType":"PATTERN_PARSE_MONITOR_HEALTH",
   "newAggregationExpression":".%2A%3Ctd%3EServer-Is-Healthy%3C%2Ftd%3E%5Cs%2A%3Ctd%3E%28.%2A%3F%29%3C%2Ftd%3E%5B%5Cs%5CS%5D%2A"
}

</pre>


<div class="alert alert-block">
<p><strong>Alert!</strong> When defining the new command (not a predefined in agentcommand.conf: must have both "newAgentCommandLine" and "newAgentCommandContentTemplate" to form the 2 lines. Otherwise the new command will fail to create.</p>
</div>

Upon successful submission of request &quot;GET /validateInternals.html&quot; on all the servers, Commander will get the raw response from each server.<br>
<br>For the meaning of each post body field parameter, please refer to <a href="#usecase-request-options">Request Options</a>
<h3>c. Sample Response:</h3>
Based on different aggregation preference parameters, REST Commander can propagate raw server response from server without aggregation, or the aggregated data after applying specified aggregation rule.
<br>
For example, without aggregation, REST Commander returns an array of json objects, each stands for the response metadata from the server:
<pre class="prettyprint lang-json linenums">
 {
   &quot;www.jeffpei.com&quot;:{
      &quot;dataMap&quot;:{
         &quot;GET_VALIDATE_INTERNALS&quot;:{
            &quot;requestParameters&quot;:{
               &quot;AM_FULL_CONTENT&quot;:&quot;&quot;,
               &quot;HEADER_TYPE&quot;:&quot;SUPERMAN_GLOBAL&quot;,
               &quot;HTTP_METHOD&quot;:&quot;GET&quot;,
               &quot;PREPARE_TIME&quot;:&quot;2014-01-12 21:27:37.212-0800&quot;,
               &quot;TRUE_CONTENT&quot;:&quot;&quot;,
               &quot;TRUE_PORT&quot;:&quot;80&quot;,
               &quot;TRUE_URL&quot;:&quot;/validateInternals.html&quot;
            },
            &quot;responseContent&quot;:{
               &quot;isError&quot;:false,
               &quot;response&quot;:&quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;h1&gt;My Server Status&lt;/h1&gt;\n\n\n&lt;h4&gt;System Health&lt;/h4&gt;\n&lt;table border='1'&gt;\n    &lt;tr&gt;\n        &lt;td&gt;Memory-Used-KB&lt;/td&gt;\n        &lt;td&gt;19213&lt;/td&gt;\n    &lt;/tr&gt;\n  \n    &lt;tr&gt;\n        &lt;td&gt;CPU-Usage-Percent&lt;/td&gt;\n        &lt;td&gt;27.08&lt;/td&gt;\n    &lt;/tr&gt;\n\n        \n    &lt;tr&gt;\n        &lt;td&gt;Server-Is-Healthy&lt;/td&gt;\n        &lt;td&gt;True&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;Host-Name&lt;/td&gt;\n        &lt;td&gt;www.jeffpei.com&lt;/td&gt;\n    &lt;/tr&gt;\n\n\t\n\t&lt;/table&gt;\n\t\n\t\n\t&lt;h4&gt;A demo page to show a sample server health page for use cases by REST Commander.&lt;/h4&gt;\n\t\t\n\t\n\n&lt;/body&gt;\n&lt;/html&gt;&quot;,
               &quot;responseTime&quot;:&quot;2014.01.12.21.27.37.474-0800&quot;,
               &quot;statusCode&quot;:&quot;200 OK&quot;
            }
         }
      },
      &quot;fqdn&quot;:&quot;www.jeffpei.com&quot;
   },
   &quot;www.restsuperman.com&quot;:{
      &quot;dataMap&quot;:{
         &quot;GET_VALIDATE_INTERNALS&quot;:{
            &quot;requestParameters&quot;:{
               &quot;AM_FULL_CONTENT&quot;:&quot;&quot;,
               &quot;HEADER_TYPE&quot;:&quot;SUPERMAN_GLOBAL&quot;,
               &quot;HTTP_METHOD&quot;:&quot;GET&quot;,
               &quot;PREPARE_TIME&quot;:&quot;2014-01-12 21:27:37.212-0800&quot;,
               &quot;TRUE_CONTENT&quot;:&quot;&quot;,
               &quot;TRUE_PORT&quot;:&quot;80&quot;,
               &quot;TRUE_URL&quot;:&quot;/validateInternals.html&quot;
            },
            &quot;responseContent&quot;:{
               &quot;isError&quot;:false,
               &quot;response&quot;:&quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;h1&gt;My Server Status&lt;/h1&gt;\n\n\n&lt;h4&gt;System Health&lt;/h4&gt;\n&lt;table border='1'&gt;\n    &lt;tr&gt;\n        &lt;td&gt;Memory-Used-KB&lt;/td&gt;\n        &lt;td&gt;51243&lt;/td&gt;\n    &lt;/tr&gt;\n  \n    &lt;tr&gt;\n        &lt;td&gt;CPU-Usage-Percent&lt;/td&gt;\n        &lt;td&gt;7.08&lt;/td&gt;\n    &lt;/tr&gt;\n\n        \n    &lt;tr&gt;\n        &lt;td&gt;Server-Is-Healthy&lt;/td&gt;\n        &lt;td&gt;True&lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;tr&gt;\n        &lt;td&gt;Host-Name&lt;/td&gt;\n        &lt;td&gt;www.restsuperman.com&lt;/td&gt;\n    &lt;/tr&gt;\n\n\t\n\t&lt;/table&gt;\n\t\n\t\n\t&lt;h4&gt;A demo page to show a sample server health page for use cases by REST Commander.&lt;/h4&gt;\n\t\t\n\t\n\n&lt;/body&gt;\n&lt;/html&gt;&quot;,
               &quot;responseTime&quot;:&quot;2014.01.12.21.27.37.756-0800&quot;,
               &quot;statusCode&quot;:&quot;200 OK&quot;
            }
         }
      },
      &quot;fqdn&quot;:&quot;www.restsuperman.com&quot;
   },
   &quot;www.yangli907.com&quot;:{
      &quot;dataMap&quot;:{
         &quot;GET_VALIDATE_INTERNALS&quot;:{
            &quot;requestParameters&quot;:{
               &quot;AM_FULL_CONTENT&quot;:&quot;&quot;,
               &quot;HEADER_TYPE&quot;:&quot;SUPERMAN_GLOBAL&quot;,
               &quot;HTTP_METHOD&quot;:&quot;GET&quot;,
               &quot;PREPARE_TIME&quot;:&quot;2014-01-12 21:27:37.212-0800&quot;,
               &quot;TRUE_CONTENT&quot;:&quot;&quot;,
               &quot;TRUE_PORT&quot;:&quot;80&quot;,
               &quot;TRUE_URL&quot;:&quot;/validateInternals.html&quot;
            },
            &quot;responseContent&quot;:{
               &quot;isError&quot;:false,
               &quot;response&quot;:&quot;&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n&lt;body&gt;\r\n\r\n&lt;h1&gt;My Server Status&lt;/h1&gt;\r\n\r\n\r\n&lt;h4&gt;System Health&lt;/h4&gt;\r\n&lt;table border='1'&gt;\r\n    &lt;tr&gt;\r\n        &lt;td&gt;Memory-Used-KB&lt;/td&gt;\r\n        &lt;td&gt;28338&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n  \r\n    &lt;tr&gt;\r\n        &lt;td&gt;CPU-Usage-Percent&lt;/td&gt;\r\n        &lt;td&gt;23.54&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n\r\n        \r\n    &lt;tr&gt;\r\n        &lt;td&gt;Server-Is-Healthy&lt;/td&gt;\r\n        &lt;td&gt;False&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n    &lt;tr&gt;\r\n        &lt;td&gt;Host-Name&lt;/td&gt;\r\n        &lt;td&gt;www.yangli907.com&lt;/td&gt;\r\n    &lt;/tr&gt;\r\n\r\n\t\r\n\t&lt;/table&gt;\r\n\t\r\n\t\r\n\t&lt;h4&gt;A demo page to show a sample server health page for use cases by REST Commander.&lt;/h4&gt;\r\n\t\t\r\n\t\r\n\r\n&lt;/body&gt;\r\n&lt;/html&gt;\r&quot;,
               &quot;responseTime&quot;:&quot;2014.01.12.21.27.37.223-0800&quot;,
               &quot;statusCode&quot;:&quot;200 OK&quot;
            }
         }
      },
      &quot;fqdn&quot;:&quot;www.yangli907.com&quot;
   }
}
</pre>
Further, enable the aggregation by setting  <strong>"willAggregateResponse":true</strong> in the request POST body: aggregation on the "Server-Is-Healthy" row, the returned result is as below:

<pre class="prettyprint lang-json linenums">
{
   &quot;aggregationMap&quot;:{
      &quot;False&quot;:&quot;1&quot;,
      &quot;True&quot;:&quot;2&quot;
   },
   &quot;aggregationValueToNodesList&quot;:[
      {
         &quot;isError&quot;:false,
         &quot;nodeList&quot;:[
            &quot;www.yangli907.com&quot;
         ],
         &quot;value&quot;:&quot;False&quot;
      },
      {
         &quot;isError&quot;:false,
         &quot;nodeList&quot;:[
            &quot;www.jeffpei.com&quot;,
            &quot;www.restsuperman.com&quot;
         ],
         &quot;value&quot;:&quot;True&quot;
      }
   ]
}
</pre>

        </section>

<section id="usecase-different-servers">
          <div class="page-header">
            <h1>2.Different Requests to Different Servers</h1>
          </div>

          <p class="lead"> Here is the use cases when you need to query different job progress on different servers, or push different configs to different servers. 
          Assuming we have a list of different servers, where each server runs its own job with a different job id. Via a unique job URL you can access a page describing the job id running on the server, 
          and its current job execution progress: 
          </p>

<ul>
  <li> <a href="http://www.yangli907.com/job_a.html">http://www.yangli907.com/job_a.html</a></li>
  <li><a href="http://www.jeffpei.com/job_b.html">http://www.jeffpei.com/job_b.html</a></li>
<li><a href="http://www.restsuperman.com/job_c.html">http://www.restsuperman.com/job_c.html</a></li>
</ul>



          Each of the job html page has the content such as below:
          <pre class="prettyprint lang-html linenums">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;body&gt;
&lt;h1&gt;My Job Status&lt;/h1&gt;
&lt;table border='1'&gt;
    &lt;tr&gt;
        &lt;td&gt;JobID&lt;/td&gt;
        &lt;td&gt;51243&lt;/td&gt;
    &lt;/tr&gt;
	&lt;tr&gt;
        &lt;td&gt;JobProgress&lt;/td&gt;
        &lt;td&gt;80%&lt;/td&gt;
    &lt;/tr&gt;
&lt;/table&gt;
	&lt;h4&gt;A demo page to show a sample server-based job status page for use cases by REST Commander.&lt;/h4&gt;
&lt;/body&gt;
&lt;/html&gt;          
          </pre>
          
          As you can see, the HTTP request sent to each server is different. With REST Commander, you can easily automate the process to send different requests to each server.  
          <h3>a. Define  Request Type and Aggregation Rules</h3>

          The first step is to define request command with server-specific variable replacement template, where the <b>$APIVARREPLACE_JOBID</b> is the stub to be replaced based on each server:
<pre>
GET_JOB_STATUS GET https 80 /$APIVARREPLACE_JOBID 0 -1 -1 SUPERMAN_GLOBAL
```$AM_FULL_CONTENT
</pre>
In the actual request which REST Commander sends to each server, the stub (variable) will be replaced accordingly, for example, Commander will replace it to <b>job_a.html</b> when sending request to server www.yangli907.com, and to <b>job_b.html</b> when sending to server www.jeffpei.com.<br>(for the meaning of each segment above in the command, please refer to <a href="documentation.html#a_Commands">Commands Section</a> in Documentation page.
<br><br>Then you need to define the aggregation rules, which tells REST Commander what's the value we are interested in to aggregate. For example, in the request, we need to specify the name(&quot;aggregationType&quot;) and expression(&quot;newAggregationExpression&quot;) of the aggregation rule:
<pre>&quot;aggregationType&quot; : &quot;PATTERN_PARSE_JOB_PROGRESS&quot;,<br>&quot;newAggregationExpression&quot; : &quot;.*&lt;td&gt;JobProgress&lt;/td&gt;\s*&lt;td&gt;(.*?)&lt;/td&gt;[\s\S]*&quot;</pre>
Here the <b>(.*?)</b> expression shows we need to extract the content in the html table cell at "JobProgress" row.
<h3>b. Sample Request: </h3>
The second step is building the json request body, which tells REST Commander how to build http request for each server, and what's the aggregation rules.

Please note the aggregation expression will be URL encoded in the json request body.<br><br>POST http://localhost:9000/commands/genUpdateSendCommandWithReplaceVarMapNodeSpecificAdhocJson (Commander running at http://localhost:9000)
<pre class="prettyprint lang-json linenums">
{
   "targetNodes":["www.yangli907.com","www.jeffpei.com","www.restsuperman.com"],
   "willAggregateResponse":false,
   "useNewAggregation":true,
   "aggregationType":"PATTERN_AGGREGATE_JOB_STATUS",
   "agentCommandType":"GET_JOB_PROGRESS",
   "newAgentCommandLine":"GET_JOB_STATUS GET http 80 /$APIVARREPLACE_JOB_NAME 0 0 5000 SUPERMAN_GLOBAL",
   "useNewAgentCommand":"true",
   "newAggregationExpression":".%2A%3Ctd%3EJobProgress%3C%2Ftd%3E%5Cs%2A%3Ctd%3E%28.%2A%3F%29%3C%2Ftd%3E%5B%5Cs%5CS%5D%2A",
   "newAgentCommandContentTemplate":"$AM_FULL_CONTENT",
   "replacementVarMapNodeSpecific":{
     "www.yangli907.com":{
       "map":{
         "APIVARREPLACE_JOB_NAME":"job_a.html"
         }
       },
     "www.jeffpei.com":{
       "map":{
         "APIVARREPLACE_JOB_NAME":"job_b.html"
         }
       }
     ,
     "www.restsuperman.com":{
       "map":{
         "APIVARREPLACE_JOB_NAME":"job_c.html"
         }
       }
     }
     
}
</pre>
For the meaning of each post body field parameter, please refer to <a href="#usecase-request-options">Request Options</a>
<h3>c. Sample Response:</h3>
Based on different aggregation preference parameters, REST Commander can list raw server response from server without aggregation, or the aggregated data after applying specified aggregation rule.
<br>
For example, without aggregation, REST Commander returns an array of json objects, each stands for the response metadata from one server:
<pre class="prettyprint lang-java linenums">
{
    &quot;www.jeffpei.com&quot;: {
        &quot;fqdn&quot;: &quot;www.jeffpei.com&quot;,
        &quot;dataMap&quot;: {
            &quot;GET_JOB_STATUS&quot;: {
                &quot;requestParameters&quot;: {
                    &quot;TRUE_URL&quot;: &quot;/job_b.html&quot;,
                    &quot;PREPARE_TIME&quot;: &quot;2014-01-18 13:29:58.980-0800&quot;,
                    &quot;NODE_REQUEST_WILL_EXECUTE&quot;: &quot;true&quot;,
                    &quot;REPLACE-VAR_APIVARREPLACE_JOB_NAME&quot;: &quot;job_b.html&quot;,
                    &quot;AM_FULL_CONTENT&quot;: &quot;&quot;,
                    &quot;TRUE_PORT&quot;: &quot;80&quot;,
                    &quot;HEADER_TYPE&quot;: &quot;SUPERMAN_GLOBAL&quot;,
                    &quot;HTTP_METHOD&quot;: &quot;GET&quot;,
                    &quot;TRUE_CONTENT&quot;: &quot;&quot;
                },
                &quot;responseContent&quot;: {
                    &quot;response&quot;: &quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;h1&gt;My Job Status&lt;/h1&gt;\n\n&lt;table border=&#39;1&#39;&gt;\n    &lt;tr&gt;\n        &lt;td&gt;JobID&lt;/td&gt;\n        &lt;td&gt;51243&lt;/td&gt;\n    &lt;/tr&gt;\n                &lt;tr&gt;\n        &lt;td&gt;JobProgress&lt;/td&gt;\n        &lt;td&gt;80%&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n                &lt;h4&gt;A demo page to show a sample server-based job status page for use cases by REST Commander.&lt;/h4&gt;\n&lt;/body&gt;\n&lt;/html&gt;&quot;,
                    &quot;responseTime&quot;: &quot;2014.01.18.13.29.59.425-0800&quot;,
                    &quot;statusCode&quot;: &quot;200 OK&quot;,
                    &quot;isError&quot;: false
                }
            }
        }
    },
    &quot;www.restsuperman.com&quot;: {
        &quot;fqdn&quot;: &quot;www.restsuperman.com&quot;,
        &quot;dataMap&quot;: {
            &quot;GET_JOB_STATUS&quot;: {
                &quot;requestParameters&quot;: {
                    &quot;TRUE_URL&quot;: &quot;/job_c.html&quot;,
                    &quot;PREPARE_TIME&quot;: &quot;2014-01-18 13:29:58.981-0800&quot;,
                    &quot;NODE_REQUEST_WILL_EXECUTE&quot;: &quot;true&quot;,
                    &quot;REPLACE-VAR_APIVARREPLACE_JOB_NAME&quot;: &quot;job_c.html&quot;,
                    &quot;AM_FULL_CONTENT&quot;: &quot;&quot;,
                    &quot;TRUE_PORT&quot;: &quot;80&quot;,
                    &quot;HEADER_TYPE&quot;: &quot;SUPERMAN_GLOBAL&quot;,
                    &quot;HTTP_METHOD&quot;: &quot;GET&quot;,
                    &quot;TRUE_CONTENT&quot;: &quot;&quot;
                },
                &quot;responseContent&quot;: {
                    &quot;response&quot;: &quot;&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;h1&gt;My Job Status&lt;/h1&gt;\n\n&lt;table border=&#39;1&#39;&gt;\n    &lt;tr&gt;\n        &lt;td&gt;JobID&lt;/td&gt;\n        &lt;td&gt;77727&lt;/td&gt;\n    &lt;/tr&gt;\n                &lt;tr&gt;\n        &lt;td&gt;JobProgress&lt;/td&gt;\n        &lt;td&gt;27%&lt;/td&gt;\n    &lt;/tr&gt;\n&lt;/table&gt;\n                &lt;h4&gt;A demo page to show a sample server-based job status page for use cases by REST Commander.&lt;/h4&gt;\n&lt;/body&gt;\n&lt;/html&gt;&quot;,
                    &quot;responseTime&quot;: &quot;2014.01.18.13.30.00.033-0800&quot;,
                    &quot;statusCode&quot;: &quot;200 OK&quot;,
                    &quot;isError&quot;: false
                }
            }
        }
    },
    &quot;www.yangli907.com&quot;: {
        &quot;fqdn&quot;: &quot;www.yangli907.com&quot;,
        &quot;dataMap&quot;: {
            &quot;GET_JOB_STATUS&quot;: {
                &quot;requestParameters&quot;: {
                    &quot;TRUE_URL&quot;: &quot;/job_a.html&quot;,
                    &quot;PREPARE_TIME&quot;: &quot;2014-01-18 13:29:58.981-0800&quot;,
                    &quot;NODE_REQUEST_WILL_EXECUTE&quot;: &quot;true&quot;,
                    &quot;REPLACE-VAR_APIVARREPLACE_JOB_NAME&quot;: &quot;job_a.html&quot;,
                    &quot;AM_FULL_CONTENT&quot;: &quot;&quot;,
                    &quot;TRUE_PORT&quot;: &quot;80&quot;,
                    &quot;HEADER_TYPE&quot;: &quot;SUPERMAN_GLOBAL&quot;,
                    &quot;HTTP_METHOD&quot;: &quot;GET&quot;,
                    &quot;TRUE_CONTENT&quot;: &quot;&quot;
                },
                &quot;responseContent&quot;: {
                    &quot;response&quot;: &quot;\n&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;h1&gt;My Job Status&lt;/h1&gt;\n\n&lt;table border=&#39;1&#39;&gt;\n    &lt;tr&gt;\n        &lt;td&gt;JobID&lt;/td&gt;\n        &lt;td&gt;32145&lt;/td&gt;\n    &lt;/tr&gt;\n\t&lt;tr&gt;\n        &lt;td&gt;JobProgress&lt;/td&gt;\n        &lt;td&gt;95%&lt;/td&gt;\n    &lt;/tr&gt;\n\n\n\t\n\t&lt;/table&gt;\n\t\n\t\n\t&lt;h4&gt;A demo page to show a sample server-based job status page for use cases by REST Commander.&lt;/h4&gt;\n\t\t\n\t\n\n&lt;/body&gt;\n&lt;/html&gt;&quot;,
                    &quot;responseTime&quot;: &quot;2014.01.18.13.29.59.087-0800&quot;,
                    &quot;statusCode&quot;: &quot;200 OK&quot;,
                    &quot;isError&quot;: false
                }
            }
        }
    }
}</pre>
<br>Further, enable the aggregation by setting  <strong>"willAggregateResponse":true</strong> in the request POST body: with aggregation on the "JobProgress" row, the returned result is as below:
<pre class="prettyprint lang-java linenums">
{
    &quot;aggregationMap&quot;: {
        &quot;27%&quot;: &quot;1&quot;,
        &quot;80%&quot;: &quot;1&quot;,
        &quot;95%&quot;: &quot;1&quot;
    },
    &quot;aggregationValueToNodesList&quot;: [
        {
            &quot;value&quot;: &quot;27%&quot;,
            &quot;nodeList&quot;: [
                &quot;www.restsuperman.com&quot;
            ],
            &quot;isError&quot;: false
        },
        {
            &quot;value&quot;: &quot;80%&quot;,
            &quot;nodeList&quot;: [
                &quot;www.jeffpei.com&quot;
            ],
            &quot;isError&quot;: false
        },
        {
            &quot;value&quot;: &quot;95%&quot;,
            &quot;nodeList&quot;: [
                &quot;www.yangli907.com&quot;
            ],
            &quot;isError&quot;: false
        }
    ]
}</pre>
          
</section>          
        <!-- HTML template
        ================================================== -->
        <section id="usecase-different-requests">
          <div class="page-header">
            <h1>3. Different Requests to Same Server</h1>
          </div>
     
          <p class="lead"> Commander can send the same set of requests via (1) UI Wizards and (2) REST APIs; here we show the REST APIs; for the corresponding step by step screenshots of the wizard part: check <a href="documentation.html#Wizards">Wizards</a> and <a href="documentation.html#Response-Persistence">Response Analysis and Logs</a> sections in "Documentation" page.</p>

          REST Commander API also supports using template to define node-specific requests, send to remote hosts and aggregate the returned response. <br>Here is an example to demonstrate how to define REST Commander command, and post request to query weather information for different cities from a single WSDL-based forecast website, which shows how to define such type of request(assuming server is running on localhost).



          <h3>a. Define Command</h3>
<pre class="prettyprint lang-java ">
GET_PUBLIC_WEATHER_APIVARREPLACE POST http 80 /WeatherWS/Weather.asmx 20 -1 -1 HEADER_PUBLIC_WEATHER
```&lt;soapenv:Envelope xmlns:soapenv=&quot;http://schemas.xmlsoap.org/soap/envelope/&quot; xmlns:weat=&quot;http://ws.cdyne.com/WeatherWS/&quot;&gt;&lt;soapenv:Header/&gt;&lt;soapenv:Body&gt;&lt;weat:GetCityWeatherByZIP&gt;&lt;weat:ZIP&gt;$APIVARREPLACE_ZIP_VAR&lt;/weat:ZIP&gt;&lt;/weat:GetCityWeatherByZIP&gt;&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;
</pre>      
<h3>b. Send Request</h3>              
<pre class="prettyprint lang-java linenums">
POST URL: http://localhost:9000/commands/genUpdateSendCommandWithReplaceVarMapNodeSpecificAdhocJson   (Commander running at http://localhost:9000)
POST BODY:
{
   "targetNodes":[
      "95131",
      "95132",
      "95037",
      "48824",
      "48823"
   ],  
   "willAggregateResponse":true,
   "useNewAggregation":false,  
   "aggregationType":"PATTERN_WEATHER_WSDL_CITY",  
   "agentCommandType":"GET_PUBLIC_WEATHER_APIVARREPLACE",
   "replacementVarMapNodeSpecific":{
      "95131":{
         "map":{
            "APIVARREPLACE_ZIP_VAR":"95131",
  			"APIVARREPLACE_SUPERMANSPECIAL_TARGET_NODE_VAR":"wsf.cdyne.com"
         }
      },
 	  "95132":{
         "map":{
            "APIVARREPLACE_ZIP_VAR":"95132",
  			"APIVARREPLACE_SUPERMANSPECIAL_TARGET_NODE_VAR":"wsf.cdyne.com"
         }
      },
       "95133":{
         "map":{
            "APIVARREPLACE_ZIP_VAR":"95133",
   			"APIVARREPLACE_SUPERMANSPECIAL_TARGET_NODE_VAR":"wsf.cdyne.com"
         }
      },
      "95037":{
         "map":{
            "APIVARREPLACE_ZIP_VAR":"95037",
   			"APIVARREPLACE_SUPERMANSPECIAL_TARGET_NODE_VAR":"wsf.cdyne.com"
         }
      },
  	   "48824":{
         "map":{
            "APIVARREPLACE_ZIP_VAR":"48824",
   			"APIVARREPLACE_SUPERMANSPECIAL_TARGET_NODE_VAR":"wsf.cdyne.com"
         }
      },
      "48823":{
         "map":{
            "APIVARREPLACE_ZIP_VAR":"48823",
   			"APIVARREPLACE_SUPERMANSPECIAL_TARGET_NODE_VAR":"wsf.cdyne.com"
         }
      }
   }
}
</pre>
For the meaning of each post body field parameter, please refer to <a href="#usecase-request-options">Request Options</a>
<h3>c.Aggregated Response</h3>
          User can define regular expression for custom response aggregation. For example, in this request body we use a pre-defined aggregation rule of <strong>PATTERN_WEATHER_WSDL_CITY</strong> with the regex &quot;<b>```.*&lt;City&gt;(.*?)&lt;/City&gt;.*</b> &quot; . It aggregates the response based on "City" attribute:
<pre class="prettyprint lang-java linenums">
{
    "aggregationMap": {
        "East Lansing": "2",
        "Morgan Hill": "1",
        "San Jose": "2"
    },
    "aggregationValueToNodesList": [
        {
            "value": "East Lansing",
            "nodeList": [
                "48823",
                "48824"
            ],
            "isError": false
        },
        {
            "value": "Morgan Hill",
            "nodeList": [
                "95037"
            ],
            "isError": false
        },
        {
            "value": "San Jose",
            "nodeList": [
                "95131",
                "95132"
            ],
            "isError": false
        }
    ]
}
</pre>

Further, you can change the aggregation rule to <strong>PATTERN_WEATHER_WSDL_TEMPERATURE</strong> with  regex &quot;<b>```.*&lt;Temperature &gt;(.*?)&lt;/Temperature&gt;.*</b> &quot; to aggregate the temperature of these areas:
<pre class="prettyprint lang-java linenums">
{
    "aggregationMap": {
        "18": "2",
        "49": "2",
        "56": "1"
    },
    "aggregationValueToNodesList": [
        {
            "value": "18",
            "nodeList": [
                "48823",
                "48824"
            ],
            "isError": false
        },
        {
            "value": "49",
            "nodeList": [
                "95131",
                "95132"
            ],
            "isError": false
        },
        {
            "value": "56",
            "nodeList": [
                "95037"
            ],
            "isError": false
        }
    ]
}
</pre>
</section>
<section id="usecase-request-options">
          <div class="page-header">
            <h1>4. Request Options</h1>
          </div>
          <p class="lead">In the json request, user can enable various request options, such as enabling aggregation, defining  new command, custom aggregation rules, etc.</p>
          <table class="table table-striped table-hover">
              <thead>
                <tr>
                <th>Option</th>
                <th>Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>targetNodes</td>
                  <td><b>(Required)</b> Target servers to which REST Commander sends the request</td>
                </tr>
                <tr>
                  <td>agentCommandType</td>
                  <td><b>(Required)</b> Name of the agent command, which can be defined either in the .conf file, or in "newAgentCommandLine" request parameter.</td>
                </tr>
                <tr>
                  <td>useNewAgentCommand</td>
                  <td><b>(Optional, default: false)</b> Option to not use pre-defined commands; but to use a new command defined by 2 lines: "newAgentCommandLine" and "newAgentCommandContentTemplate". <strong>Remember a command is awlays defined by *TWO* lines. Missing one will fail the request!</strong>. If set to true, "newAgentCommandLine" and "newAgentCommandContentTemplate" parameters are mandatory, and command defined with same name in .conf file will be overridden by it.</td>
                </tr>
                <tr>
                  <td>newAgentCommandLine</td>
                  <td><b>(Optional)</b> New custom agent command expression. If "useNewAgentCommand" option is true, this field is mandatory.</td>
                </tr>
                <tr>
                  <td>willAggregateResponse</td>
                  <td><b>(Optional, default: false)</b> Option to aggregate the response based on aggregation rule. If it's set to true, </td>
                </tr>
                <tr>
                  <td>aggregationType</td>
                  <td><b>(Required)</b>Name of the aggregation type, which can be defined either in the .conf file, or in "newAggregationExpression" request parameter.</td>
                </tr>
                <tr>
                  <td>useNewAggregation</td>
                  <td><b>(Optional, default:false)</b>Option to enable new aggregation defined in the "newAggregationExpression" parameter.</td>
                </tr>
                <tr>
                  <td>newAggregationExpression</td>
                  <td><b>(Optional)</b>Custom regular expression to aggregate the response.</td>
                </tr>
              </tbody>
            </table>
        </section>

      </div>
    </div>

  </div>





    <!-- Footer
    ================================================== -->
    <footer class="footer">

      <div class="container">
       
        <p>Code licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0" target="_blank">Apache License v2.0</a>, documentation and video under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.

          <script type="text/javascript">
var sc_project=9543227; 
var sc_invisible=0; 
var sc_security="1ab09d11"; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("<sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'></"+"script>");
</script>
<noscript><div class="statcounter"><a title="hits counter"
href="http://statcounter.com/free-hit-counter/"
target="_blank"><img class="statcounter"
src="http://c.statcounter.com/9543227/0/1ab09d11/0/"
alt="hits counter"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide -->

        </p>
    
      </div>



       <p>&copy; 2013-2014 eBay Software Foundation</p>
    </footer>
 <script src="public/javascripts/jquery.js"></script>
 <script src="public/javascripts/bootstrap.min.js"></script>
  <script src="public/javascripts/prettify/prettify.js"></script>
 
</body>
</html>

